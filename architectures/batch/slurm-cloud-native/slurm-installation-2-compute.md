# Slurm Installation Compute[0-x]

### 2 - Compute Node


#### 2.2 - configuring munge
- copying munge key from __control node__ ( [step 1.0](https://github.com/rcardona-os/mydocs/blob/main/hpc/slurm/slurm-installation-1-control.md) )
```bash
$ sudo scp /etc/munge/munge.key compute0:/etc/munge/munge.key
```
- starting munge process in __compute node__
```bash
$ sudo chown munge:munge /etc/munge/munge.key
```
```bash
$ sudo systemctl enable munge
```
```bash
$ sudo systemctl start munge
```
```bash
$ sudo systemctl status munge
```

#### 2.3 - configuring slurm
- installing slurm
```bash
$ sudo dnf install slurm slurm-slurmd -y
```
- configuring and starting slurm
```bash
$ sudo mkdir -p {/var/spool/slurmd,/var/log/slurm}
```
```bash
$ sudo chown slurm:slurm /var/spool/slurmd /var/log/slurm
```
```bash
$ sudo touch {/var/log/slurm/slurm_jobacct.log,/var/log/slurm/slurm_jobcomp.log}
```
```bash
$ sudo chown -R slurm:slurm /var/log/slurm
```
```bash
$ sudo chmod 0755 /var/log/slurm
```
 
- copy/update **slurm.conf** from the control node ( STEP ), please visit this [site](https://slurm.schedmd.com/configurator.easy.html) for reference
```bash
$ sudo cat /etc/slurm/slurm.conf
```
```text
# slurm.conf file generated by configurator easy.html.
ClusterName=localcluster
#SlurmctldHost=localhost
SlurmctldHost=control
#
ProctrackType=proctrack/cgroup
ReturnToService=1
SlurmctldPidFile=/var/run/slurmctld.pid
SlurmctldPort=6817
SlurmdPidFile=/var/run/slurmd.pid
SlurmdPort=6818
SlurmdSpoolDir=/var/spool/slurmd
SlurmUser=slurm
StateSaveLocation=/var/spool/slurmctld
TaskPlugin=task/affinity,task/cgroup
#
#TIMERS
KillWait=30
MinJobAge=300
SlurmctldTimeout=120
SlurmdTimeout=300
#
# SCHEDULING
SchedulerType=sched/backfill
SelectType=select/cons_tres
#
# LOGGING AND ACCOUNTING
AccountingStorageHost=localhost
AccountingStorageType=accounting_storage/slurmdbd
SlurmctldDebug=info
SlurmctldLogFile=/var/log/slurmctld.log
SlurmdDebug=info
SlurmdLogFile=/var/log/slurmd.log
#
# COMPUTE NODES
#NodeName=localhost CPUs=1 State=UNKNOWN
NodeName=compute0 CPUs=1 State=UNKNOWN
PartitionName=debug Nodes=ALL Default=YES MaxTime=INFINITE State=UP
```
- starting slurmd
```bash
$ sudo systemctl enable slurmd
```
```bash
$ sudo systemctl start slurmd
```
```bash
$ sudo systemctl status slurmd
```
